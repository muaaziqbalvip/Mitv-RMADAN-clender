<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MI RAMADAN PRO | ICS SCIENCE EXPERT EDITION</title>
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ffcc33">
<meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/png" href="https://i.ibb.co/rKM2mKWt/1771605401569.png">
<link rel="apple-touch-icon" href="https://i.ibb.co/rKM2mKWt/1771605401569.png">
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-messaging-compat.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Poppins:wght@100;300;400;600;800&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>

    <style>
        /* ================================================
           MEGA CSS ARCHITECTURE (MOBILE OPTIMIZED)
           ================================================
        */
        :root {
            --gold: #ffcc33;
            --dark-bg: #010409;
            --card-bg: rgba(13, 17, 23, 0.85);
            --neon-green: #39ff14;
            --neon-red: #ff3131;
            --text-main: #e6edf3;
            --mi-gradient: linear-gradient(145deg, #0d1117, #010409);
        }

        * {
            margin: 0; padding: 0; box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--dark-bg);
            color: var(--text-main);
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
            width: 100%;
        }

        /* Live Ramadan Particles Background */
        #aura-canvas {
            position: fixed; top: 0; left: 0; z-index: -1; width: 100%; height: 100%;
        }

        /* High-End Header Bar */
        .mi-header {
            width: 100%; height: 75px; background: rgba(1, 4, 9, 0.9);
            backdrop-filter: blur(15px); border-bottom: 2px solid var(--gold);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; position: sticky; top: 0; z-index: 1000;
        }

        .mi-logo {
            font-family: 'Orbitron', sans-serif; font-weight: 900;
            font-size: 1.4rem; color: var(--gold); text-shadow: 0 0 10px rgba(255,204,51,0.5);
        }

        /* Mobile Responsive Grid System */
        .main-container {
            width: 100%; padding: 15px; display: none; /* Permission based */
            max-width: 600px; margin: 0 auto; padding-bottom: 120px;
        }

        /* Advanced Clock Display */
        .hero-section {
            background: var(--mi-gradient); border-radius: 25px;
            padding: 30px 15px; border: 1px solid rgba(255,204,51,0.2);
            text-align: center; margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .timer-label {
            font-family: 'Orbitron'; font-size: 0.7rem; letter-spacing: 3px;
            color: var(--gold); text-transform: uppercase;
        }

        #countdown {
            font-family: 'Orbitron'; font-size: 3.5rem; font-weight: 900;
            color: #fff; text-shadow: 0 0 20px var(--gold); margin: 10px 0;
        }

        /* Quick Stats Grid */
        .stats-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--card-bg); padding: 20px; border-radius: 20px;
            text-align: center; border: 1px solid rgba(255,255,255,0.05);
            transition: 0.3s;
        }

        .stat-card:active { transform: scale(0.95); border-color: var(--gold); }
        .stat-card h5 { font-size: 0.6rem; color: var(--gold); text-transform: uppercase; margin-bottom: 8px; }
        .stat-card .val { font-family: 'Orbitron'; font-size: 1.2rem; font-weight: 700; }

        /* Prayer Times List (Mobile Style) */
        .prayer-list {
            background: var(--card-bg); border-radius: 25px; padding: 20px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .prayer-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .prayer-item:last-child { border-bottom: none; }
        .p-name { display: flex; align-items: center; gap: 10px; font-weight: 600; }
        .p-time { color: var(--gold); font-family: 'Orbitron'; font-size: 1rem; }

        /* Multi-Level Permission Overlay */
        #mi-gate {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--dark-bg); z-index: 2000;
            display: flex; flex-direction: column; align-items: center;
            justify-content: center; padding: 30px; text-align: center;
        }

        .gate-content {
            background: var(--card-bg); border: 2px solid var(--gold);
            padding: 40px 20px; border-radius: 35px; width: 100%;
            animation: slideUp 0.8s ease;
        }

        .btn-activate {
            background: var(--gold); color: #000; border: none;
            padding: 18px 40px; border-radius: 50px; font-weight: 900;
            font-family: 'Orbitron'; margin-top: 30px; cursor: pointer;
            width: 100%; box-shadow: 0 0 20px rgba(255,204,51,0.4);
        }

        /* Fixed Footer (Social & Dev) */
        .mi-footer-fixed {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(1, 4, 9, 0.95); border-top: 2px solid var(--gold);
            padding: 12px 15px; z-index: 1001;
        }

        .dev-tag {
            font-size: 0.65rem; color: var(--gold); font-weight: 800;
            text-align: center; margin-bottom: 8px; font-family: 'Orbitron';
        }

        .social-row {
            display: flex; justify-content: space-around; font-size: 1.2rem;
        }

        .social-row a { color: #fff; transition: 0.3s; }
        .social-row a:hover { color: var(--gold); }

        /* Full Calendar Overlay */
        #calendar-view {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--dark-bg); z-index: 1500; display: none;
            overflow-y: auto; padding: 20px; padding-bottom: 100px;
        }

        .cal-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.8rem; }
        .cal-table th { background: var(--gold); color: #000; padding: 10px; }
        .cal-table td { padding: 12px 8px; border-bottom: 1px solid #222; text-align: center; }

        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
/* Header Time Box Styling */
.header-right-side {
    display: flex;
    align-items: center;
    gap: 12px;
}

.mi-header-clock {
    background: rgba(255, 204, 51, 0.15);
    border: 1px solid var(--gold);
    padding: 5px 12px;
    border-radius: 8px;
    font-family: 'Orbitron', sans-serif;
    color: var(--gold);
    font-size: 0.85rem;
    font-weight: 700;
    box-shadow: 0 0 10px rgba(255, 204, 51, 0.2);
    min-width: 90px;
    text-align: center;
}

/* Mobile adjust for long headings */
@media (max-width: 400px) {
    .mi-logo { font-size: 1.1rem; }
    .mi-header-clock { font-size: 0.75rem; padding: 4px 8px; min-width: 75px; }
}
/* Digital Tasbeeh Section Styling */
.tasbeeh-container {
    background: var(--mi-gradient);
    border: 2px solid var(--gold);
    border-radius: 30px;
    padding: 30px 20px;
    margin-top: 25px;
    text-align: center;
    box-shadow: 0 15px 40px rgba(0,0,0,0.6);
    position: relative;
    overflow: hidden;
}

.tasbeeh-display {
    background: #000;
    border: 4px inset #222;
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
}

#tasbeeh-count {
    font-family: 'Orbitron', sans-serif;
    font-size: 4rem;
    color: var(--gold);
    text-shadow: 0 0 20px rgba(255, 204, 51, 0.6);
    display: block;
}

.tasbeeh-label {
    font-size: 0.8rem;
    color: #aaa;
    letter-spacing: 2px;
    text-transform: uppercase;
}

.tasbeeh-buttons {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 25px;
}

.btn-count {
    width: 90px;
    height: 90px;
    background: radial-gradient(circle, var(--gold), #b8860b);
    border: none;
    border-radius: 50%;
    box-shadow: 0 8px 0 #8b6508, 0 15px 25px rgba(0,0,0,0.4);
    cursor: pointer;
    active: transform: translateY(5px);
    active: box-shadow: 0 2px 0 #8b6508;
    transition: 0.1s;
}

.btn-reset {
    background: #333;
    color: #fff;
    border: 1px solid #555;
    padding: 10px 20px;
    border-radius: 10px;
    font-size: 0.7rem;
    font-family: 'Orbitron';
}
/* Random Hadith Section */
.hadith-container {
    background: linear-gradient(rgba(255, 204, 51, 0.05), rgba(0, 0, 0, 0.8));
    border: 1px solid rgba(255, 204, 51, 0.3);
    border-radius: 20px;
    padding: 25px;
    margin-top: 25px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.hadith-icon {
    font-size: 1.5rem;
    color: var(--gold);
    margin-bottom: 15px;
}

#hadith-text {
    font-family: 'Amiri', serif;
    font-size: 1.1rem;
    line-height: 1.8;
    color: #fff;
    margin-bottom: 15px;
    display: block;
}

#hadith-ref {
    font-size: 0.75rem;
    color: var(--gold);
    font-weight: 600;
    font-style: italic;
}

.btn-refresh-hadith {
    background: none;
    border: 1px solid var(--gold);
    color: var(--gold);
    padding: 5px 15px;
    border-radius: 50px;
    font-size: 0.7rem;
    margin-top: 15px;
    cursor: pointer;
    transition: 0.3s;
}

.btn-refresh-hadith:hover {
    background: var(--gold);
    color: #000;
}
/* Random Quranic Ayat Section */
.ayat-container {
    background: linear-gradient(rgba(57, 255, 20, 0.05), rgba(0, 0, 0, 0.9));
    border: 1px solid rgba(57, 255, 20, 0.2);
    border-radius: 25px;
    padding: 25px;
    margin-top: 25px;
    text-align: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
}

.ayat-arabic {
    font-family: 'Amiri', serif;
    font-size: 1.6rem;
    color: var(--neon-green);
    margin-bottom: 15px;
    direction: rtl;
    line-height: 2;
    display: block;
}

#ayat-translation {
    font-size: 1rem;
    color: #e6edf3;
    line-height: 1.6;
    font-style: italic;
    margin-bottom: 10px;
    display: block;
}

#ayat-ref {
    font-family: 'Orbitron';
    font-size: 0.7rem;
    color: var(--gold);
    letter-spacing: 1px;
}

.btn-refresh-ayat {
    background: rgba(255, 204, 51, 0.1);
    border: 1px solid var(--gold);
    color: var(--gold);
    padding: 8px 20px;
    border-radius: 50px;
    font-size: 0.7rem;
    margin-top: 15px;
    cursor: pointer;
}
/* Live Quran FM Bar Styling */
.radio-container {
    background: linear-gradient(135deg, rgba(255, 204, 51, 0.1), rgba(0, 0, 0, 0.9));
    border: 1px solid var(--gold);
    border-radius: 20px;
    padding: 20px;
    margin-top: 25px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    box-shadow: 0 10px 30px rgba(255, 204, 51, 0.1);
}

.radio-info {
    display: flex;
    align-items: center;
    gap: 15px;
    width: 100%;
}

.radio-visualizer {
    width: 50px;
    height: 50px;
    background: var(--gold);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: #000;
    box-shadow: 0 0 15px var(--gold);
}

.radio-meta {
    flex-grow: 1;
}

.radio-meta h4 {
    font-family: 'Orbitron';
    font-size: 0.9rem;
    color: var(--gold);
    margin: 0;
}

.radio-meta p {
    font-size: 0.7rem;
    color: #aaa;
    margin: 3px 0 0 0;
}

.radio-controls {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255,255,255,0.05);
    padding: 10px 15px;
    border-radius: 15px;
}

.btn-play-radio {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: var(--gold);
    border: none;
    color: #000;
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: 0.3s;
}

.btn-play-radio:active {
    transform: scale(0.9);
}

/* Visualizer Animation */
.playing .radio-visualizer {
    animation: pulse-gold 1.5s infinite;
}

@keyframes pulse-gold {
    0% { box-shadow: 0 0 0 0 rgba(255, 204, 51, 0.7); }
    70% { box-shadow: 0 0 0 15px rgba(255, 204, 51, 0); }
    100% { box-shadow: 0 0 0 0 rgba(255, 204, 51, 0); }
}
/* Random Iftar Dua Section */
.dua-container {
    background: linear-gradient(rgba(255, 49, 49, 0.05), rgba(0, 0, 0, 0.9));
    border: 1px solid rgba(255, 204, 51, 0.3);
    border-radius: 25px;
    padding: 25px;
    margin-top: 25px;
    text-align: center;
    box-shadow: 0 10px 25px rgba(0,0,0,0.5);
    border-left: 4px solid var(--gold);
}

.dua-arabic {
    font-family: 'Amiri', serif;
    font-size: 1.5rem;
    color: var(--gold);
    margin-bottom: 15px;
    direction: rtl;
    line-height: 2.2;
    display: block;
    text-shadow: 0 0 10px rgba(255, 204, 51, 0.3);
}

#dua-translation {
    font-size: 0.95rem;
    color: #e6edf3;
    line-height: 1.6;
    margin-bottom: 10px;
    display: block;
    font-style: italic;
}

.dua-title {
    font-family: 'Orbitron';
    font-size: 0.7rem;
    color: var(--neon-red);
    letter-spacing: 2px;
    margin-bottom: 10px;
    text-transform: uppercase;
}

.btn-refresh-dua {
    background: rgba(255, 204, 51, 0.1);
    border: 1px solid var(--gold);
    color: var(--gold);
    padding: 8px 20px;
    border-radius: 50px;
    font-size: 0.7rem;
    margin-top: 15px;
    cursor: pointer;
    transition: 0.3s;
}
/* Sehri Dua Section Styling */
.sehri-dua-container {
    background: linear-gradient(rgba(0, 255, 255, 0.05), rgba(0, 0, 0, 0.9));
    border: 1px solid rgba(255, 204, 51, 0.3);
    border-radius: 25px;
    padding: 25px;
    margin-top: 25px;
    text-align: center;
    box-shadow: 0 10px 25px rgba(0,0,0,0.5);
    border-right: 4px solid var(--gold);
}

.sehri-dua-arabic {
    font-family: 'Amiri', serif;
    font-size: 1.5rem;
    color: var(--gold);
    margin-bottom: 15px;
    direction: rtl;
    line-height: 2.2;
    display: block;
}

#sehri-translation {
    font-size: 0.95rem;
    color: #e6edf3;
    line-height: 1.6;
    margin-bottom: 10px;
    display: block;
    font-style: italic;
}

.sehri-title {
    font-family: 'Orbitron';
    font-size: 0.7rem;
    color: #00ffff;
    letter-spacing: 2px;
    margin-bottom: 10px;
    text-transform: uppercase;
}
/* ================================================
   LIVE TV PLAYER CSS (MI GOLD EDITION)
   ================================================ */
.tv-container {
    background: #000;
    border: 2px solid var(--gold);
    border-radius: 20px;
    margin-top: 25px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 30px rgba(255, 204, 51, 0.2);
}

.tv-header {
    background: rgba(255, 204, 51, 0.1);
    padding: 10px 15px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-bottom: 1px solid rgba(255, 204, 51, 0.3);
}

.tv-logo {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    border: 1px solid var(--gold);
    object-fit: cover;
}

#mi-video {
    width: 100%;
    aspect-ratio: 16/9;
    display: block;
    background: #000;
}

.tv-controls {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(transparent, rgba(0,0,0,0.95));
    padding: 12px 15px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    opacity: 0;
    transition: 0.3s ease;
    z-index: 10;
}

/* Mobile par touch karne se controls dikhen */
.tv-container:hover .tv-controls, 
.tv-container:active .tv-controls { opacity: 1; }

.btn-tv {
    background: none;
    border: none;
    color: #fff;
    font-size: 1.2rem;
    cursor: pointer;
    transition: 0.2s;
}

.btn-tv:hover { color: var(--gold); }

.live-badge {
    background: var(--neon-red);
    color: #fff;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.6rem;
    font-weight: 800;
    font-family: 'Orbitron';
    animation: blink-red 1s infinite;
}

@keyframes blink-red { 50% { opacity: 0.5; } }
/* Live News Ticker Styling */
.ticker-wrapper {
    width: 100%;
    background: #000;
    border-bottom: 1px solid var(--gold);
    height: 35px;
    display: flex;
    align-items: center;
    overflow: hidden;
    position: sticky;
    top: 75px; /* Header ke bilkul niche */
    z-index: 999;
}

.ticker-label {
    background: var(--gold);
    color: #000;
    padding: 0 15px;
    height: 100%;
    display: flex;
    align-items: center;
    font-family: 'Orbitron';
    font-size: 0.7rem;
    font-weight: 900;
    z-index: 10;
    white-space: nowrap;
    box-shadow: 5px 0 15px rgba(0,0,0,0.5);
}

.ticker-content {
    display: inline-block;
    white-space: nowrap;
    padding-left: 100%;
    animation: ticker-scroll 25s linear infinite;
    font-size: 0.85rem;
    color: var(--gold);
    font-family: 'Poppins';
}

.ticker-item {
    display: inline-block;
    padding: 0 30px;
}

.ticker-item i {
    margin-right: 8px;
    color: #fff;
}

@keyframes ticker-scroll {
    0% { transform: translate3d(0, 0, 0); }
    100% { transform: translate3d(-100%, 0, 0); }
}

/* Pause scroll on hover/touch */
.ticker-wrapper:hover .ticker-content {
    animation-play-state: paused;
}
/* Floating Install Button */
#pwa-install-btn {
    display: none; /* Shuru mein chhupa rahega */
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--gold);
    color: #000;
    padding: 12px 25px;
    border-radius: 50px;
    font-family: 'Orbitron';
    font-weight: 900;
    font-size: 0.8rem;
    border: none;
    box-shadow: 0 10px 20px rgba(0,0,0,0.4), 0 0 15px var(--gold);
    z-index: 9999;
    cursor: pointer;
    align-items: center;
    gap: 10px;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {transform: translateX(-50%) translateY(0);}
    40% {transform: translateX(-50%) translateY(-10px);}
    60% {transform: translateX(-50%) translateY(-5px);}
}
/* Live Stats Bar Styling */
.social-stats-bar {
    display: flex;
    justify-content: space-around;
    align-items: center;
    background: rgba(255, 204, 51, 0.1);
    border: 1px solid var(--gold);
    padding: 10px;
    border-radius: 15px;
    margin: 20px 0;
    font-family: 'Orbitron', sans-serif;
}

.stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}

.stat-label {
    font-size: 0.6rem;
    color: #aaa;
    text-transform: uppercase;
}

.stat-value {
    font-size: 1.1rem;
    color: var(--gold);
    font-weight: 700;
}

#like-trigger {
    background: none;
    border: 1px solid var(--gold);
    color: var(--gold);
    padding: 5px 15px;
    border-radius: 20px;
    cursor: pointer;
    transition: 0.3s;
}

#like-trigger.liked {
    background: var(--gold);
    color: #000;
}
.chat-container {
    background: var(--card-bg);
    border: 1px solid var(--gold);
    border-radius: 20px;
    margin-top: 25px;
    overflow: hidden;
}
.chat-header {
    background: rgba(255, 204, 51, 0.1);
    padding: 10px;
    font-family: 'Orbitron';
    font-size: 0.8rem;
    color: var(--gold);
    text-align: center;
    border-bottom: 1px solid rgba(255, 204, 51, 0.2);
}
.chat-box {
    height: 200px;
    overflow-y: auto;
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    background: rgba(0,0,0,0.3);
}
.msg {
    background: rgba(255,255,255,0.05);
    padding: 8px 12px;
    border-radius: 12px;
    font-size: 0.85rem;
    border-left: 3px solid var(--gold);
    animation: slideIn 0.3s ease;
}
.chat-input-area {
    display: flex;
    padding: 10px;
    gap: 10px;
    background: #000;
}
#user-msg {
    flex-grow: 1;
    background: #111;
    border: 1px solid #333;
    color: #fff;
    padding: 8px 15px;
    border-radius: 50px;
    outline: none;
}
.chat-input-area button {
    background: var(--gold);
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
}
#user-name {
    background: rgba(255, 204, 51, 0.05);
    border: 1px solid rgba(255, 204, 51, 0.3);
    color: var(--gold);
    padding: 5px 12px;
    border-radius: 8px;
    font-size: 0.75rem;
    outline: none;
}
.msg-container {
    background: rgba(255,255,255,0.05);
    padding: 10px;
    border-radius: 12px;
    border-left: 3px solid var(--gold);
    margin-bottom: 8px;
}
.u-name {
    color: var(--gold);
    font-size: 0.7rem;
    font-weight: 800;
    display: block;
    margin-bottom: 3px;
    text-transform: uppercase;
}
.u-text {
    font-size: 0.85rem;
    color: #fff;
}
/* Enable Notification Button Styling */
.action-btn {
    background: linear-gradient(45deg, #000, #1a1a1a);
    color: var(--gold);
    border: 2px solid var(--gold);
    padding: 12px 25px;
    border-radius: 50px;
    font-family: 'Orbitron', sans-serif;
    font-size: 0.8rem;
    font-weight: 700;
    letter-spacing: 1px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin: 20px auto;
    transition: all 0.3s ease;
    box-shadow: 0 0 10px rgba(255, 204, 51, 0.2);
    text-transform: uppercase;
}

.action-btn:hover {
    background: var(--gold);
    color: #000;
    box-shadow: 0 0 20px var(--gold);
    transform: translateY(-2px);
}

.action-btn i, .action-btn span {
    font-size: 1.1rem;
}

/* Glowing Animation */
@keyframes pulse-gold {
    0% { box-shadow: 0 0 5px var(--gold); }
    50% { box-shadow: 0 0 20px var(--gold); }
    100% { box-shadow: 0 0 5px var(--gold); }
}

.action-btn.glowing {
    animation: pulse-gold 2s infinite;
}
/* Verified Badge Styling */
.verified-badge {
    background: #1da1f2; /* Twitter wala blue color */
    color: white;
    font-size: 0.6rem;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 5px;
    font-weight: 900;
    vertical-align: middle;
}

/* Admin Message special highlight */
.admin-msg {
    border-left: 4px solid #1da1f2 !important;
    background: rgba(29, 161, 242, 0.05) !important;
}

.admin-msg .u-name {
    color: #1da1f2 !important;
}

    </style>
</head>
<body>

    <canvas id="aura-canvas"></canvas>

    <div id="mi-gate">
        <div class="gate-content">
            <h1 style="color: var(--gold); font-family: 'Orbitron';">MI RAMADAN CLENDER</h1>
            <p style="margin: 20px 0; font-size: 0.9rem; line-height: 1.6; opacity: 0.8;">
                Assalam-o-Alaikum ALL VIEWERS KO Muaaz Iqbal! KI TRAF SE RMADAN MUBARAK.<br>
                For Precise Location Timings & Loud Alarms, we need your permission.
            </p>
            <button class="btn-activate" onclick="startEngine()">GRANT ACCESS</button>
        </div>
    </div>

    <header class="mi-header">
    <div class="mi-logo">ğŸ…¼ğŸ…¸â„¢ ğ—¥ğ—”ğ— ğ—”ğ——ğ—”ğ—¡</div>
    
    <div class="header-right-side">
        <div class="mi-header-clock" id="header-live-clock">00:00:00</div>
        
        <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 4px;">
            <i class="fas fa-bell" id="alarm-icon" style="color: var(--gold); font-size: 0.9rem;"></i>
            <span id="loc-tag" style="font-size: 0.5rem; background: rgba(255,204,51,0.2); padding: 2px 6px; border-radius: 4px; border: 0.5px solid var(--gold);">SYNCING</span>
        </div>
    </div>
</header>
<div class="ticker-wrapper">
    <div class="ticker-label">LATEST UPDATES</div>
    <div class="ticker-content" id="mi-ticker">
        <div class="ticker-item"><i class="fas fa-bullhorn"></i> Welcome to MI RAMADAN CLENDER THATS DEVELOPED BY MUAAZ IQBAL - ICS Science Expert Edition</div>
        <div class="ticker-item"><i class="fas fa-clock"></i> Live Sehri & Iftar Countdown Active</div>
        <div class="ticker-item"><i class="fas fa-tv"></i> Watch Paigham TV Live Stream with Maximize Mode</div>
        <div class="ticker-item"><i class="fas fa-microphone"></i> Listen Live Quran FM by Mishary Rashid Alafasy</div>
        <div class="ticker-item"><i class="fas fa-fingerprint"></i> Digital Tasbeeh Counter with Haptic Feedback Ready</div>
        <div class="ticker-item"><i class="fas fa-star"></i> Random Quranic Ayat & Ahadees updated daily</div>
        <div class="ticker-item"><i class="fas fa-bell"></i> Loud Alarm Notification System Integrated</div>
    </div>
</div>
<button id="pwa-install-btn">
    <i class="fas fa-download"></i> INSTALL MI RAMADAN PRO
</button>
<button onclick="requestNotificationPermission()" class="action-btn glowing">
    <span>ğŸ””</span> Enable Notifications
</button>

    <div class="main-container" id="main-ui">
        
        <div class="hero-section">
            <div class="timer-label" id="timer-title">Next Event Loading...</div>
            <div id="countdown">00:00:00</div>
            <div id="hijri-box" style="font-family: 'Amiri'; color: var(--gold); font-size: 1.4rem;">-- Ramadan 1447</div>
            
        </div>

        <div class="stats-grid">
    <div class="stat-card">
        <h5>ROZE GUZRE</h5>
        <div class="val" id="count-done">0</div>
    </div>
    <div class="stat-card" onclick="toggleCalendar(true)" style="cursor:pointer; border: 1px solid var(--gold);">
        <h5>ROZE BAQI</h5>
        <div class="val" id="count-left" style="color:var(--gold);">30</div>
        <small style="font-size:0.5rem; color:var(--gold)">VIEW CALENDAR</small>
    </div>
    <div class="stat-card">
        <h5>SEHRI ENDS</h5>
        <div class="val" id="sehri-val" style="color:var(--neon-green);">--:--</div>
    </div>
    <div class="stat-card">
        <h5>IFTAR STARTS</h5>
        <div class="val" id="iftar-val" style="color:var(--neon-red);">--:--</div>
    </div>
</div>
        <div class="radio-container" id="radio-box">
    <div class="radio-info">
        <div class="radio-visualizer">
            <i class="fas fa-broadcast-tower"></i>
        </div>
        <div class="radio-meta">
            <h4>LIVE QURAN FM</h4>
            <p id="radio-status">Station: Mishary Rashid Alafasy</p>
        </div>
    </div>

    <div class="radio-controls">
        <div style="font-size: 0.6rem; color: var(--gold); font-family: 'Orbitron';">LIVE STREAMING...</div>
        <button class="btn-play-radio" onclick="toggleRadio()" id="radio-btn">
            <i class="fas fa-play" id="radio-icon"></i>
        </button>
    </div>    
    <audio id="quran-radio" src="https://radio.mp3islam.com/listen/mishary/radio.mp3"></audio>
</div>

        <div class="ayat-container">
    <div style="color: var(--neon-green); margin-bottom: 10px;"><i class="fas fa-quran"></i></div>
    <div id="ayat-box">
        <span class="ayat-arabic" id="ayat-ar">ÙŠÙØ§ Ø£ÙÙŠÙÙ‘Ù‡ÙØ§ Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ø¢Ù…ÙÙ†ÙÙˆØ§ ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù Ø§Ù„ØµÙÙ‘ÙŠÙØ§Ù…Ù</span>
        <span id="ayat-translation">"Aay logon jo imaan laye ho, tum par roze farz kiye gaye hain..."</span>
        <div id="ayat-ref">Surah Al-Baqarah: 183</div>
    </div>
    <button class="btn-refresh-ayat" onclick="generateAyat()">REFRESH AYAT</button>
    <div class="social-stats-bar">
    <div class="stat-item">
        <span class="stat-label">Online</span>
        <span id="online-count" class="stat-value">0</span>
    </div>
    <div class="stat-item">
        <span class="stat-label">Views</span>
        <span id="view-count" class="stat-value">0</span>
    </div>
    <button id="like-trigger" onclick="handleLike()">
        â¤ï¸ <span id="like-count">0</span>
    </div>
</div>

</div>

<div class="hadith-container">
    <div class="hadith-icon"><i class="fas fa-book-open"></i></div>
    <div id="hadith-box">
        <span id="hadith-text">Ramadan ki fazeelat loading...</span>
        <div id="hadith-ref">---</div>
    </div>
    <button class="btn-refresh-hadith" onclick="generateHadith()">NEXT HADITH</button>
</div>

        <div class="prayer-list">
            <h4 style="font-family: 'Orbitron'; font-size: 0.8rem; margin-bottom: 15px; border-left: 3px solid var(--gold); padding-left: 10px;">TODAY'S NAMAZ</h4>
            <div id="prayer-items-box">
                </div>
        </div>
<div class="tv-container" id="mi-tv-wrapper">
    <div class="tv-header">
        <img src="https://i.ibb.co/gMhwDPS8/Pegamtv.jpg" class="tv-logo" alt="Paigham TV">
        <div style="flex-grow: 1;">
            <h4 style="font-family: 'Orbitron'; font-size: 0.8rem; color: var(--gold); margin: 0;">PAIGHAM TV</h4>
            <div class="live-badge">LIVE STREAM</div>
        </div>
    </div>

    <video id="mi-video" playsinline crossorigin="anonymous"></video>

    <div class="tv-controls">
        <div style="display: flex; gap: 20px;">
            <button class="btn-tv" onclick="toggleTV()"><i class="fas fa-play" id="tv-icon"></i></button>
            <button class="btn-tv" onclick="toggleMute()"><i class="fas fa-volume-up" id="vol-icon"></i></button>
        </div>
        
        <div style="display: flex; align-items: center; gap: 15px;">
            <div style="font-size: 0.5rem; color: #aaa; font-family: 'Orbitron'; letter-spacing: 1px;">MI ENGINE 2.0</div>
            <button class="btn-tv" onclick="toggleFullscreen()"><i class="fas fa-expand" id="expand-icon"></i></button>
        </div>
    </div>
</div>
    </div>
<div class="tasbeeh-container">
    <div class="tasbeeh-label">Digital Tasbeeh Counter</div>
    <div class="tasbeeh-display">
        <span id="tasbeeh-count">000</span>
    </div>
    
    <div class="tasbeeh-buttons">
        <button class="btn-reset" onclick="resetTasbeeh()">RESET</button>
        <button class="btn-count" onclick="countTasbeeh()"></button>       
    </div>
    
    <div style="margin-top: 15px; font-size: 0.7rem; color: var(--gold); font-family: 'Amiri';">
        SubhanAllah â€¢ Alhamdulillah â€¢ Allahu Akbar
    </div>
</div>
<div class="dua-container">
    <div class="dua-title"><i class="fas fa-hand-holding-heart"></i> Iftar Ki Dua</div>
    <div id="dua-box">
        <span class="dua-arabic" id="dua-ar">Ø°ÙÙ‡ÙØ¨Ù Ø§Ù„Ø¸ÙÙ‘Ù…ÙØ£Ù ÙˆÙØ§Ø¨Ù’ØªÙÙ„ÙÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù</span>
        <span id="dua-translation">"Pyaas bujh gayi, ragen tar ho gayin aur ajr pakka ho gaya InshaAllah."</span>
    </div>
    <button class="btn-refresh-dua" onclick="generateDua()">NEXT DUA</button>
</div>
<div class="sehri-dua-container">
    <div class="sehri-title"><i class="fas fa-cloud-sun"></i> Sehri Ki Niyat</div>
    <div id="sehri-box">
        <span class="sehri-dua-arabic">ÙˆÙØ¨ÙØµÙÙˆÙ’Ù…Ù ØºÙØ¯Ù Ù†ÙÙ‘ÙˆÙÙŠÙ’ØªÙ Ù…ÙÙ†Ù’ Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù</span>
        <span id="sehri-translation">"Aur maine kal ke Ramadan ke roze ki niyat ki."</span>
        <div class="social-stats-bar">
    <div class="stat-item">
        <span class="stat-label">Online</span>
        <span id="online-count" class="stat-value">0</span>
    </div>
    <div class="stat-item">
        <span class="stat-label">Views</span>
        <span id="view-count" class="stat-value">0</span>
    </div>
    <button id="like-trigger" onclick="handleLike()">
        â¤ï¸ <span id="like-count">0</span>
    </div>
</div>

    </div>
</div>
<div class="chat-container">
    <div class="chat-header"><i class="fas fa-comments"></i> PUBLIC FEEDBACK</div>
    <div id="chat-messages" class="chat-box">
        </div>
    <div class="chat-input-area" style="flex-direction: column; gap: 5px;">
        <input type="text" id="user-name" placeholder="Your Name" maxlength="20" style="width: 100%; margin-bottom: 5px;">
        <div style="display: flex; gap: 10px; width: 100%;">
            <input type="text" id="user-msg" placeholder="Write feedback..." maxlength="100" style="flex-grow: 1;">
            <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>

<div class="dua-container">
    <div class="dua-title"><i class="fas fa-hand-holding-heart"></i> Iftar Ki Dua</div>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>

<div class="social-stats-bar">
    <span>Online: <id id="online-count">0</id></span>
    <span>Views: <id id="view-count">0</id></span>
    <button id="like-trigger" onclick="handleLike()">â¤ï¸ <span id="like-count">0</span></button>
</div>

    <div id="dua-box">
        <span class="dua-arabic" id="dua-ar">Ø°ÙÙ‡ÙØ¨Ù Ø§Ù„Ø¸ÙÙ‘Ù…ÙØ£Ù ÙˆÙØ§Ø¨Ù’ØªÙÙ„ÙÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù</span>
        <span id="dua-translation">"Pyaas bujh gayi, ragen tar ho gayin aur ajr pakka ho gaya InshaAllah."</span>
    </div>
    <button class="btn-refresh-dua" onclick="generateDua()">NEXT DUA</button>
</div>
    <div class="mi-footer-fixed">
        <div class="dev-tag">DEVELOPED BY ğŒğ”ğ€ğ€ğ™ ğˆğğğ€ğ‹ | ICS SCIENCE EXPERT</div>
        
        <div class="social-row">
            <a href="https://whatsapp.com/channel/0029VbBxejr4tRryT1wVqu0D"><i class="fab fa-whatsapp"></i></a>
            <a href="https://t.me/MITV_NETWORK"><i class="fab fa-telegram"></i></a>
            <a href="https://m.youtube.com/@muslimislamofficial"><i class="fab fa-youtube"></i></a>
            <a href="https://www.facebook.com/share/14Xf5k1kc2J/"><i class="fab fa-facebook"></i></a>
            
        </div>
    </div>

    <div id="calendar-view" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:var(--dark-bg); z-index:9999; overflow-y:auto; padding:20px;">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="font-family:'Orbitron'; color:var(--gold);">RAMADAN 2026</h2>
        <button onclick="toggleCalendar(false)" style="background:var(--gold); border:none; padding:5px 15px; border-radius:10px; font-weight:bold;">CLOSE</button>
    </div>
  <table class="cal-table">
    <thead>
        <tr>
            <th>R#</th>
            <th style="text-align:left; padding-left:10px;">DATE/DAY</th>
            <th>SEHRI</th>
            <th>IFTAR</th>
        </tr>
    </thead>
    <tbody id="cal-body">
        </tbody>
</table>


    <audio id="alarm-audio" src="https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg" preload="auto"></audio>

    <script>
        
        /* ================================================
   MEGA JAVASCRIPT ENGINE (MANUAL DESIGN LOGIC)
   ================================================ */

let userLat, userLon;
let apiData = null;
const alarmNode = document.getElementById('alarm-audio');

// 1. Aapka Manually Designed Accurate Data (19 Feb Start)
const ramadanData = [
    { date: "19 Feb", day: "Thursday", sehri: "05:18", iftar: "17:58" },
    { date: "20 Feb", day: "Friday", sehri: "05:17", iftar: "17:59" },
    { date: "21 Feb", day: "Saturday", sehri: "05:16", iftar: "18:00" },
    { date: "22 Feb", day: "Sunday", sehri: "05:15", iftar: "18:01" },
    { date: "23 Feb", day: "Monday", sehri: "05:14", iftar: "18:02" },
    { date: "24 Feb", day: "Tuesday", sehri: "05:13", iftar: "18:03" },
    { date: "25 Feb", day: "Wednesday", sehri: "05:12", iftar: "18:04" },
    { date: "26 Feb", day: "Thursday", sehri: "05:11", iftar: "18:05" },
    { date: "27 Feb", day: "Friday", sehri: "05:10", iftar: "18:05" },
    { date: "28 Feb", day: "Saturday", sehri: "05:08", iftar: "18:06" },
    { date: "01 Mar", day: "Sunday", sehri: "05:07", iftar: "18:07" },
    { date: "02 Mar", day: "Monday", sehri: "05:06", iftar: "18:08" },
    { date: "03 Mar", day: "Tuesday", sehri: "05:05", iftar: "18:09" },
    { date: "04 Mar", day: "Wednesday", sehri: "05:03", iftar: "18:10" },
    { date: "05 Mar", day: "Thursday", sehri: "05:02", iftar: "18:11" },
    { date: "06 Mar", day: "Friday", sehri: "05:01", iftar: "18:11" },
    { date: "07 Mar", day: "Saturday", sehri: "05:00", iftar: "18:12" },
    { date: "08 Mar", day: "Sunday", sehri: "04:58", iftar: "18:13" },
    { date: "09 Mar", day: "Monday", sehri: "04:57", iftar: "18:14" },
    { date: "10 Mar", day: "Tuesday", sehri: "04:56", iftar: "18:15" },
    { date: "11 Mar", day: "Wednesday", sehri: "04:54", iftar: "18:15" },
    { date: "12 Mar", day: "Thursday", sehri: "04:53", iftar: "18:16" },
    { date: "13 Mar", day: "Friday", sehri: "04:52", iftar: "18:17" },
    { date: "14 Mar", day: "Saturday", sehri: "04:50", iftar: "18:18" },
    { date: "15 Mar", day: "Sunday", sehri: "04:49", iftar: "18:19" },
    { date: "16 Mar", day: "Monday", sehri: "04:47", iftar: "18:19" },
    { date: "17 Mar", day: "Tuesday", sehri: "04:46", iftar: "18:20" },
    { date: "18 Mar", day: "Wednesday", sehri: "04:45", iftar: "18:21" },
    { date: "19 Mar", day: "Thursday", sehri: "04:43", iftar: "18:22" },
    { date: "20 Mar", day: "Friday", sehri: "04:42", iftar: "18:22" }
];

// 2. Start Engine
async function startEngine() {
    if (alarmNode) {
        alarmNode.play().then(() => { alarmNode.pause(); alarmNode.currentTime = 0; }).catch(() => {});
    }

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async (pos) => {
            userLat = pos.coords.latitude; userLon = pos.coords.longitude;
            proceed();
        }, () => {
            userLat = 31.11; userLon = 74.44; proceed();
        });
    }
}

function proceed() {
    document.getElementById('mi-gate').style.display = 'none';
    document.getElementById('main-ui').style.display = 'block';
    syncData(); // Ye sirf namaz timings ke liye API use karega
    renderCalendar(); // Ye manual data use karega
    initVisuals();
    setInterval(heartbeat, 1000);
}

// 3. Sync Data (Only for Namaz Timings)
async function syncData() {
    try {
        const res = await fetch(`https://api.aladhan.com/v1/timings?latitude=${userLat}&longitude=${userLon}&method=1`);
        const json = await res.json();
        apiData = json.data;
        updateUI();
    } catch (e) { console.log("API Error"); }
}

// 4. Update UI (Dashboard)
function updateUI() {
    if (!apiData) return;
    const now = new Date();
    const todayStr = now.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' });

    // Dashboard ki Sehri/Iftar manual accurate array se uthayen
    let todayManual = ramadanData.find(d => d.date === todayStr) || ramadanData[0];
    document.getElementById('sehri-val').innerText = todayManual.sehri;
    document.getElementById('iftar-val').innerText = todayManual.iftar;

    // Namaz timings API se
    const t = apiData.timings;
    const pList = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];
    let html = '';
    pList.forEach(p => {
        html += `<div class="prayer-item">
            <div class="p-name"><i class="far fa-clock" style="color:var(--gold)"></i> ${p}</div>
            <div class="p-time">${format12(t[p])}</div>
        </div>`;
    });
    document.getElementById('prayer-items-box').innerHTML = html;

    // Roze Progress (19 Feb Start)
    const startDate = new Date('2026-02-19');
    const diff = Math.floor((now - startDate) / (1000*60*60*24)) + 1;
    const done = diff > 0 ? (diff > 30 ? 30 : diff) : 0;
    document.getElementById('count-done').innerText = done;
    document.getElementById('count-left').innerText = 30 - done;
}

// 5. Render Calendar (Manual Design Logic)
function renderCalendar() {
    let html = '';
    const todayStr = new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'short' });

    ramadanData.forEach((day, i) => {
        const rozaNo = i + 1;
        const isToday = day.date === todayStr;

        // 1. Ashra Headings Logic
        if (rozaNo === 1) {
            html += `<tr class="ashra-header" style="background:rgba(57, 255, 20, 0.15);"><td colspan="4" style="color:var(--neon-green); font-weight:900; padding:10px; font-family:Orbitron;">--- PEHLA ASHRA (REHMAT) ---</td></tr>`;
        } else if (rozaNo === 11) {
            html += `<tr class="ashra-header" style="background:rgba(255, 204, 51, 0.15);"><td colspan="4" style="color:var(--gold); font-weight:900; padding:10px; font-family:Orbitron;">--- DUSRA ASHRA (MAGHFIRAT) ---</td></tr>`;
        } else if (rozaNo === 21) {
            html += `<tr class="ashra-header" style="background:rgba(255, 49, 49, 0.15);"><td colspan="4" style="color:var(--neon-red); font-weight:900; padding:10px; font-family:Orbitron;">--- TEESRA ASHRA (NIJAT) ---</td></tr>`;
        }

        // 2. Table Row Logic
        html += `
        <tr style="${isToday ? 'background:rgba(255,204,51,0.25); border:1px solid var(--gold);' : 'border-bottom:1px solid rgba(255,255,255,0.05);'}">
            <td style="color:var(--gold); font-weight:bold; font-family:Orbitron;">${rozaNo}</td>
            <td style="text-align:left; padding-left:10px;">
                <div style="font-size:0.85rem; font-weight:bold;">${day.date}</div>
                <div style="font-size:0.65rem; color:#888;">${day.day}</div>
            </td>
            <td style="color:var(--neon-green); font-family:Orbitron; font-size:0.8rem;">${day.sehri}</td>
            <td style="color:var(--neon-red); font-family:Orbitron; font-size:0.8rem;">${day.iftar}</td>
        </tr>`;
    });
    document.getElementById('cal-body').innerHTML = html;
}



function format12(t) {
    if(!t) return "--:--";
    let [h, m] = t.split(':');
    let ampm = h >= 12 ? 'PM' : 'AM';
    h = h % 12 || 12;
    return `${h}:${m} ${ampm}`;
}

function toggleCalendar(show) {
    document.getElementById('calendar-view').style.display = show ? 'block' : 'none';
}


        // 6. Real-time Heartbeat (Countdown & Alarm)
        /* ================================================
   CORE HEARTBEAT ENGINE - FULL ACTION LOGIC
   ================================================
*/
function heartbeat() {
    if (!apiData) return;

    const now = new Date();
    
    // --- PART 1: 12-HOUR HEADER CLOCK LOGIC ---
    let hours = now.getHours();
    let minutes = now.getMinutes();
    let seconds = now.getSeconds();
    let ampm = hours >= 12 ? 'PM' : 'AM';
    // Har minute check karega
if (typeof min !== 'undefined') {
    checkTimeForNotifications(label, min); 
}

    hours = hours % 12;
    hours = hours ? hours : 12; // 0 ko 12 banana
    
    const hStr = hours.toString().padStart(2, '0');
    const mStr = minutes.toString().padStart(2, '0');
    const sStr = seconds.toString().padStart(2, '0');
    
    // Header mein live time update
    document.getElementById('header-live-clock').innerText = `${hStr}:${mStr}:${sStr} ${ampm}`;

    // --- PART 2: LOUD ALARM TRIGGER SYSTEM ---
    // API times usually 24h format mein hoti hain (e.g., "05:15")
    const currentTime24 = now.getHours().toString().padStart(2, '0') + ":" + mStr;
    
    const sehriTime = apiData.timings.Fajr;
    const iftarTime = apiData.timings.Maghrib;

    // Check for exact second to trigger alarm
    if ((currentTime24 === sehriTime || currentTime24 === iftarTime) && seconds === 0) {
        triggerLoudAlarm();
    }

    // --- PART 3: DYNAMIC COUNTDOWN ENGINE ---
    updateCountdownLogic(now, sehriTime, iftarTime);
}

// Sub-function for Loud Alarm
function triggerLoudAlarm() {
    const alarmNode = document.getElementById('alarm-audio');
    alarmNode.volume = 1.0; // Full Loud
    alarmNode.play().catch(e => console.log("User interaction required for audio"));
    
    // Visual Alert
    document.getElementById('alarm-icon').style.animation = "pulse 0.5s infinite";
    setTimeout(() => {
        document.getElementById('alarm-icon').style.animation = "none";
    }, 60000);
}

// Sub-function for Countdown Calculation
function updateCountdownLogic(now, sT_raw, iT_raw) {
    const sParts = sT_raw.split(':');
    const iParts = iT_raw.split(':');
    
    const sehriDate = new Date(); 
    sehriDate.setHours(sParts[0], sParts[1], 0);
    
    const iftarDate = new Date(); 
    iftarDate.setHours(iParts[0], iParts[1], 0);

    let target, label;

    if (now < sehriDate) {
        target = sehriDate;
        label = "Sehri Ends In";
    } else if (now < iftarDate) {
        target = iftarDate;
        label = "Iftar Starts In";
    } else {
        target = new Date(sehriDate);
        target.setDate(target.getDate() + 1);
        label = "Next Sehri In";
    }

    const diff = target - now;
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);

    // Main Hero Section Update
    document.getElementById('countdown').innerText = 
        `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
    document.getElementById('timer-title').innerText = label;
}

        // 7. Live Ramadan Aura (Particles)
        function initVisuals() {
            const canvas = document.getElementById('aura-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            for(let i=0; i<100; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2,
                    speed: Math.random() * 0.5,
                    opacity: Math.random()
                });
            }

            function animate() {
                ctx.clearRect(0,0, canvas.width, canvas.height);
                ctx.fillStyle = "#ffcc33";
                particles.forEach(p => {
                    ctx.globalAlpha = p.opacity;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                    ctx.fill();
                    p.y -= p.speed;
                    if(p.y < 0) p.y = canvas.height;
                });
                requestAnimationFrame(animate);
            }
            animate();
        }
// Register Service Worker for PWA
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('sw.js')
      .then(reg => console.log('MI RAMADAN PWA Registered!'))
      .catch(err => console.log('Registration Failed: ', err));
  });
}

// Add to Home Screen Prompt Logic
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  // Yahan tum chaho to koi button dikha sakte ho "Install App" ka
});
/* ================================================
   TASBEEH COUNTER LOGIC
   ================================================
*/
let count = 0;

function countTasbeeh() {
    count++;
    updateTasbeehDisplay();
    
    // Haptic Feedback (Vibration) for Mobile
    if (navigator.vibrate) {
        navigator.vibrate(50); 
    }
    
    // Sound effect on every click (Optional)
    const tickSound = new Audio('https://www.soundjay.com/buttons/button-16.mp3');
    tickSound.volume = 1.0;
    tickSound.play();
}

function resetTasbeeh() {
    if(confirm("Kya aap counter zero karna chahte hain?")) {
        count = 0;
        updateTasbeehDisplay();
    }
}

function updateTasbeehDisplay() {
    const display = document.getElementById('tasbeeh-count');
    display.innerText = count.toString().padStart(3, '0');
    
    // Golden Flash Effect
    display.style.color = "#fff";
    setTimeout(() => { display.style.color = "var(--gold)"; }, 100);
}
/* ================================================
   RANDOM HADITH ENGINE (MUAAZ IQBAL EDITION)
   ================================================
*/
const ahadees = [
    {
        text: "Jis ne imaan aur ehtisab ke sath Ramadan ke roze rakhe, us ke pichle tamam gunah maaf kar diye jayenge.",
        ref: "Sahih Bukhari: 1901"
    },
    {
        text: "Roza jahannam se bachne ke liye ek dhaal hai.",
        ref: "Sahih Muslim: 1151"
    },
    {
        text: "Ramadan ki har raat Allah Ta'ala bahut se logon ko jahannam se azad farmata hai.",
        ref: "Sunan Ibn Majah: 1643"
    },
    {
        text: "Roze dar ke liye do khushiyan hain: ek iftar ke waqt aur ek apne Rab se mulaqat ke waqt.",
        ref: "Sahih Bukhari: 1904"
    },
    {
        text: "Jannat ka ek darwaza hai jis ka naam 'Rayyan' hai, jis se qayamat ke din sirf roze dar dakhil honge.",
        ref: "Sahih Muslim: 1152"
    }
];

function generateHadith() {
    const randomIndex = Math.floor(Math.random() * ahadees.length);
    const selectedHadith = ahadees[randomIndex];
    
    const textElem = document.getElementById('hadith-text');
    const refElem = document.getElementById('hadith-ref');
    
    // Fade effect animation
    textElem.style.opacity = 0;
    setTimeout(() => {
        textElem.innerText = `"${selectedHadith.text}"`;
        refElem.innerText = `â€” ${selectedHadith.ref}`;
        textElem.style.opacity = 1;
    }, 300);
}

// Initial call when dashboard loads
window.addEventListener('load', () => {
    // Agar startEngine ke andar call karna chahen to wahan bhi kar sakte hain
    generateHadith();
});
/* ================================================
   RANDOM QURANIC AYAT LOGIC
   ================================================
*/
const quranAyat = [
    {
        ar: "ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù Ø§Ù„ØµÙÙ‘ÙŠÙØ§Ù…Ù ÙƒÙÙ…ÙØ§ ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙ‰ Ø§Ù„ÙÙ‘Ø°ÙÙŠÙ†Ù Ù…ÙÙ† Ù‚ÙØ¨Ù’Ù„ÙÙƒÙÙ…Ù’ Ù„ÙØ¹ÙÙ„ÙÙ‘ÙƒÙÙ…Ù’ ØªÙØªÙÙ‘Ù‚ÙÙˆÙ†Ù",
        en: "Tum par roze farz kiye gaye hain jaise tum se pehle logon par farz kiye gaye thay, taake tum parhezgaar ban jao.",
        ref: "Surah Al-Baqarah: 183"
    },
    {
        ar: "Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø§Ù„ÙÙ‘Ø°ÙÙŠ Ø£ÙÙ†Ø²ÙÙ„Ù ÙÙÙŠÙ‡Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù Ù‡ÙØ¯Ù‹Ù‰ Ù„ÙÙ‘Ù„Ù†ÙÙ‘Ø§Ø³Ù",
        en: "Ramadan wo mahina hai jis mein Quran nazil kiya gaya, jo logon ke liye hidayat hai.",
        ref: "Surah Al-Baqarah: 185"
    },
    {
        ar: "ÙˆÙØ£ÙÙ† ØªÙØµÙÙˆÙ…ÙÙˆØ§ Ø®ÙÙŠÙ’Ø±ÙŒ Ù„ÙÙ‘ÙƒÙÙ…Ù’ Û– Ø¥ÙÙ† ÙƒÙÙ†ØªÙÙ…Ù’ ØªÙØ¹Ù’Ù„ÙÙ…ÙÙˆÙ†Ù",
        en: "Aur tumhara roza rakhna tumhare liye behtar hai, agar tum jante ho.",
        ref: "Surah Al-Baqarah: 184"
    },
    {
        ar: "ÙˆÙØ¥ÙØ°ÙØ§ Ø³ÙØ£ÙÙ„ÙÙƒÙ Ø¹ÙØ¨ÙØ§Ø¯ÙÙŠ Ø¹ÙÙ†ÙÙ‘ÙŠ ÙÙØ¥ÙÙ†ÙÙ‘ÙŠ Ù‚ÙØ±ÙÙŠØ¨ÙŒ",
        en: "Aur jab Mere bande Mere bare mein puchen, to (keh do) Main qareeb hoon (dua qubool karta hoon).",
        ref: "Surah Al-Baqarah: 186"
    }
];

function generateAyat() {
    const randomIdx = Math.floor(Math.random() * quranAyat.length);
    const data = quranAyat[randomIdx];
    
    // Animation transitions
    const box = document.getElementById('ayat-box');
    box.style.opacity = 0;
    box.style.transform = "translateY(10px)";
    
    setTimeout(() => {
        document.getElementById('ayat-ar').innerText = data.ar;
        document.getElementById('ayat-translation').innerText = `"${data.en}"`;
        document.getElementById('ayat-ref').innerText = data.ref;
        
        box.style.opacity = 1;
        box.style.transform = "translateY(0)";
        box.style.transition = "0.5s ease";
    }, 300);
}

// Update startEngine or window load to include this
window.addEventListener('load', () => {
    generateHadith();
    generateAyat();
});
/* ================================================
   LIVE QURAN FM ENGINE
   ================================================
*/
const radioAudio = document.getElementById('quran-radio');
const radioBtn = document.getElementById('radio-btn');
const radioIcon = document.getElementById('radio-icon');
const radioBox = document.getElementById('radio-box');
const radioStatus = document.getElementById('radio-status');

let isRadioPlaying = false;

function toggleRadio() {
    if (!isRadioPlaying) {
        // Play Radio
        radioAudio.play().then(() => {
            isRadioPlaying = true;
            radioIcon.className = "fas fa-pause";
            radioBox.classList.add('playing');
            radioStatus.innerText = "Playing: Mishary Alafasy";
            radioStatus.style.color = "var(--neon-green)";
        }).catch(err => {
            alert("Streaming link load nahi ho saki. Internet check karein.");
        });
    } else {
        // Pause Radio
        radioAudio.pause();
        isRadioPlaying = false;
        radioIcon.className = "fas fa-play";
        radioBox.classList.remove('playing');
        radioStatus.innerText = "Station: Mishary Alafasy (Paused)";
        radioStatus.style.color = "#aaa";
    }
}

// Volume Control (Mobile Optimized)
radioAudio.volume = 0.8;
/* ================================================
   RANDOM IFTAR DUA ENGINE (MUAAZ EDITION)
   ================================================
*/
const iftarDuas = [
    {
        ar: "Ø°ÙÙ‡ÙØ¨Ù Ø§Ù„Ø¸ÙÙ‘Ù…ÙØ£Ù ÙˆÙØ§Ø¨Ù’ØªÙÙ„ÙÙ‘ØªÙ Ø§Ù„Ù’Ø¹ÙØ±ÙÙˆÙ‚Ù ÙˆÙØ«ÙØ¨ÙØªÙ Ø§Ù„Ø£ÙØ¬Ù’Ø±Ù Ø¥ÙÙ†Ù’ Ø´ÙØ§Ø¡Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù",
        en: "Pyaas bujh gayi, ragen tar ho gayin aur Allah ne chaha to ajr thar gaya.",
        ref: "Sunan Abi Dawud"
    },
    {
        ar: "Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ Ù„ÙÙƒÙ ØµÙÙ…Ù’ØªÙ ÙˆÙØ¹ÙÙ„ÙÙ‰ Ø±ÙØ²Ù’Ù‚ÙÙƒÙ Ø£ÙÙÙ’Ø·ÙØ±Ù’ØªÙ",
        en: "Aye Allah! Maine Tere hi liye roza rakha aur Tere hi diye huye rizq par iftar kiya.",
        ref: "Mishkat al-Masabih"
    },
    {
        ar: "ÙŠÙØ§ ÙˆÙØ§Ø³ÙØ¹Ù Ø§Ù„Ù’ÙÙØ¶Ù’Ù„Ù Ø§ØºÙ’ÙÙØ±Ù’ Ù„ÙÙŠ",
        en: "Aye bahut bade fazl wale! Meri maghfirat farma de.",
        ref: "Iftar ke waqt ki khas dua"
    }
];

function generateDua() {
    const randomIdx = Math.floor(Math.random() * iftarDuas.length);
    const data = iftarDuas[randomIdx];
    
    const box = document.getElementById('dua-box');
    box.style.opacity = 0;
    
    setTimeout(() => {
        document.getElementById('dua-ar').innerText = data.ar;
        document.getElementById('dua-translation').innerText = `"${data.en}"`;
        box.style.opacity = 1;
        box.style.transition = "0.5s ease";
    }, 300);
}

// Window load par add karein
window.addEventListener('load', () => {
    generateHadith();
    generateAyat();
    generateDua(); // Initial Dua Load
});
/* ================================================
   PAIGHAM TV ENGINE LOGIC (MUAAZ IQBAL EDITION)
   ================================================ */
const video = document.getElementById('mi-video');
const tvWrapper = document.getElementById('mi-tv-wrapper');
const expandIcon = document.getElementById('expand-icon');
const tvIcon = document.getElementById('tv-icon');
const volIcon = document.getElementById('vol-icon');
const m3u8Url = "https://cdn22lhr.tamashaweb.com:8087/jazzauth/PaighamTV-abr/playlist.m3u8";

// 1. Fast Loading Setup (HLS)
if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(m3u8Url);
    hls.attachMedia(video);
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = m3u8Url;
}

// 2. Play/Pause Toggle
function toggleTV() {
    if (video.paused) {
        video.play();
        tvIcon.className = "fas fa-pause";
        // Agar Radio chal raha hai to usse band kar do
        if (typeof isRadioPlaying !== 'undefined' && isRadioPlaying) toggleRadio();
    } else {
        video.pause();
        tvIcon.className = "fas fa-play";
    }
}

// 3. Mute/Unmute Toggle
function toggleMute() {
    video.muted = !video.muted;
    volIcon.className = video.muted ? "fas fa-volume-mute" : "fas fa-volume-up";
}

// 4. Maximize (Fullscreen) Toggle
function toggleFullscreen() {
    if (!document.fullscreenElement) {
        if (tvWrapper.requestFullscreen) {
            tvWrapper.requestFullscreen();
        } else if (tvWrapper.webkitRequestFullscreen) { // Safari/iOS
            tvWrapper.webkitRequestFullscreen();
        } else if (video.webkitEnterFullscreen) { // iPhone specific
            video.webkitEnterFullscreen();
        }
        expandIcon.className = "fas fa-compress";
    } else {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        }
        expandIcon.className = "fas fa-expand";
    }
}

// Fullscreen exit hone par icon reset karna
document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement) {
        expandIcon.className = "fas fa-expand";
    }
});
/* ================================================
   PWA INSTALLATION ENGINE (CHROME OPTIMIZED)
   ================================================ */
const installBtn = document.getElementById('pwa-install-btn');

window.addEventListener('beforeinstallprompt', (e) => {
    // Chrome ko default prompt dikhane se rokna
    e.preventDefault();
    // Event ko save karlo taake baad mein use ho sake
    deferredPrompt = e;
    // Ab apna custom button dikhao
    installBtn.style.display = 'flex';
});

installBtn.addEventListener('click', async () => {
    if (deferredPrompt) {
        // Install prompt dikhao
        deferredPrompt.prompt();
        // User ka choice check karo
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`User response to install prompt: ${outcome}`);
        // Prompt khatam, ab dobara use nahi ho sakta
        deferredPrompt = null;
        // Button chhupa do
        installBtn.style.display = 'none';
    }
});

// Agar app pehle se install ho jaye to button gayab kar do
window.addEventListener('appinstalled', (evt) => {
    console.log('MI RAMADAN PRO was installed.');
    installBtn.style.display = 'none';
});
// Tumhare project ka specific Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyBbnU8DkthpYQMHOLLyj6M0cc05qXfjMcw",
  authDomain: "ramadan-2385b.firebaseapp.com",
  databaseURL: "https://ramadan-2385b-default-rtdb.firebaseio.com",
  projectId: "ramadan-2385b",
  storageBucket: "ramadan-2385b.firebasestorage.app",
  messagingSenderId: "882828936310",
  appId: "1:882828936310:web:7f97b921031fe130fe4b57",
  measurementId: "G-FWXBNG4RNT"
};

// Isse initialize karne ke liye:
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
/* ================================================
   MI RAMADAN LIVE ENGINE - PLUG & PLAY
   ================================================ */

function activateLiveStats() {
    // 1. Database References
    const viewsRef = db.ref('stats/totalViews');
    const onlineRef = db.ref('stats/onlineNow');
    const likesRef = db.ref('stats/totalLikes');

    // --- TOTAL VIEWS LOGIC ---
    // Jab page load ho, count 1 barha do
    viewsRef.transaction((current) => (current || 0) + 1);
    
    // Screen par update karo
    viewsRef.on('value', (snapshot) => {
        const val = snapshot.val() || 0;
        // Dono jagah update karo agar duplicate IDs hain
        document.querySelectorAll('#view-count').forEach(el => el.innerText = val);
    });

    // --- ONLINE USERS LOGIC ---
    const myPresence = onlineRef.push(true);
    myPresence.onDisconnect().remove(); // Tab band hone par minus

    onlineRef.on('value', (snapshot) => {
        const count = snapshot.numChildren();
        document.querySelectorAll('#online-count').forEach(el => el.innerText = count);
    });

    // --- LIKES LOGIC ---
    likesRef.on('value', (snapshot) => {
        const val = snapshot.val() || 0;
        document.querySelectorAll('#like-count').forEach(el => el.innerText = val);
    });
}

// Like Button Function (Jo line 536 par onclick="handleLike()" hai)
function handleLike() {
    if (!localStorage.getItem('mi_ramadan_liked')) {
        db.ref('stats/totalLikes').transaction(c => (c || 0) + 1);
        localStorage.setItem('mi_ramadan_liked', 'true');
        alert("Shukran! Aapka Like save ho gaya.");
    } else {
        alert("Aap pehle hi like kar chuke hain.");
    }
}

// Isse page load hone par chalayen
window.addEventListener('load', () => {
    activateLiveStats();
});
// Chat Logic with Name Support
const chatRef = db.ref('public_chat');

// Admin Key (Ise secret rakho, ya badal lo)
const ADMIN_KEY = "MI123"; 

function sendMessage() {
    const nameInput = document.getElementById('user-name');
    const msgInput = document.getElementById('user-msg');
    
    let name = nameInput.value.trim() || "Anonymous";
    const msg = msgInput.value.trim();
    
    if (msg !== "") {
        let isAdmin = false;
        
        // Agar tum apna naam "Muaaz MI123" likho ge to verified badge lag jaye ga
        if (name.includes(ADMIN_KEY)) {
            name = "Muaaz Iqbal"; // Screen par sirf asli naam dikhe
            isAdmin = true;
        }

        chatRef.push({
            username: name,
            text: msg,
            role: isAdmin ? "admin" : "user", // Database mein role save karein
            timestamp: Date.now()
        });
        
        msgInput.value = "";
    }
}

// Live display update logic
chatRef.limitToLast(15).on('child_added', (snapshot) => {
    const data = snapshot.val();
    const chatBox = document.getElementById('chat-messages');
    
    // Check karein ke message admin ka hai ya nahi
    const badge = data.role === "admin" ? '<span class="verified-badge">âœ“ OWNER</span>' : '';
    const adminClass = data.role === "admin" ? 'admin-msg' : '';

    const msgHtml = `
        <div class="msg-container ${adminClass}">
            <span class="u-name">${data.username} ${badge}</span>
            <span class="u-text">${data.text}</span>
        </div>`;
    
    chatBox.innerHTML += msgHtml;
    chatBox.scrollTop = chatBox.scrollHeight;
});

// 1. Messaging Initialize
const messaging = firebase.messaging();

// 2. Notification Permission Request
function requestNotificationPermission() {
    Notification.requestPermission().then((permission) => {
        if (permission === 'granted') {
            console.log('Notification permission granted.');
            // Token le sakte hain agar server se bhejna ho
        } else {
            console.log('Unable to get permission to notify.');
        }
    });
}

// 3. Simple Notification Function
function sendLocalNotification(title, body) {
    if (Notification.permission === 'granted') {
        const options = {
            body: body,
            icon: 'https://i.ibb.co/rKM2mKWt/1771605401569.png', // Tumhara app icon
            badge: 'https://i.ibb.co/rKM2mKWt/1771605401569.png',
            vibrate: [200, 100, 200]
        };
        new Notification(title, options);
    }
}

// 4. Time-Based Alerts (Iftar/Namaz)
function checkTimeForNotifications(label, minutesLeft) {
    // Agar 5 minute reh gaye hon to notification jaye
    if (minutesLeft === 5) {
        sendLocalNotification("Alert!", `${label} mein sirf 5 minute reh gaye hain. Tayyar ho jayen!`);
    }
    // Bilkul waqt hone par
    if (minutesLeft === 0) {
        sendLocalNotification("Ma-Sha-Allah", `${label} ka waqt ho gaya hai!`);
    }
}
function requestNotificationPermission() {
    Notification.requestPermission().then((permission) => {
        if (permission === 'granted') {
            console.log('Permission Granted!');
            // Button ko chhupane ke liye
            document.querySelector('.action-btn').style.display = 'none';
        }
    });
}
// Database se notifications listen karna
db.ref('notifications/latest').on('value', (snapshot) => {
    const data = snapshot.val();
    if (data) {
        // Check karein ke ye notification purana to nahi (last 30 seconds mein aaya ho)
        const now = Date.now();
        if (now - data.timestamp < 30000) {
            // Browser notification dikhana
            sendLocalNotification(data.title, data.body);
            
            // Website ke andar bhi ek popup dikha sakte hain (Optional)
            console.log("New Admin Announcement: " + data.body);
        }
    }
});

    </script>
    
</body>
</html>